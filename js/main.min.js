var container,camera,scene,renderer,effect,raycaster,ring,canvas;!1===WEBGL.isWebGLAvailable()&&document.body.appendChild(WEBGL.getWebGLErrorMessage());var tooltip,texture,tooltipContext,sprite,spheres=[],rotations=[],IS_OPEN=!1;tooltip=document.createElement("canvas"),(tooltipContext=tooltip.getContext("2d")).fillStyle="#FF0000",tooltipContext.font="Bold 20px Arial",tooltipContext.fillStyle="rgba(0,0,0,0.95)",tooltipContext.fillText("Adam here!",0,20),(texture=new THREE.Texture(tooltip)).needsUpdate=!0;var INTERSECTED,mouse=new THREE.Vector2,mouseX=0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;function init(){container=document.createElement("div"),document.body.appendChild(container),(camera=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.01,100)).position.z=20,camera.focalLength=3,(scene=new THREE.Scene).background=new THREE.Color(16448250);for(var e=new THREE.IcosahedronBufferGeometry(.3,0),t=(new THREE.MeshStandardMaterial({emissive:6456575}),[{project:"wunderlist",material:new THREE.MeshStandardMaterial({emissive:14241092}),scale:5*Math.random()+1,displayName:"Wunderlist"},{project:"stickynotes",material:new THREE.MeshStandardMaterial({emissive:16106828}),scale:4*Math.random()+1,displayName:"Microsoft"},{project:"secret",material:new THREE.MeshStandardMaterial({emissive:0}),scale:2*Math.random()+1,displayName:"Secret"},{project:"photography",material:new THREE.MeshStandardMaterial({emissive:4549983}),scale:3*Math.random()+1,displayName:"Photography"},{project:"illustrations",material:new THREE.MeshStandardMaterial({emissive:16547665}),scale:2*Math.random()+1,displayName:"Illustrations"},{project:"knightlyrage",material:new THREE.MeshStandardMaterial({emissive:11118252}),scale:3*Math.random()+1,displayName:"Game Dev"}]),n=0;n<t.length;n++){var i=new THREE.Mesh(e,t[n].material);t[n].material.shadowSide=THREE.DoubleSide,i.position.x=10*Math.random(),i.position.y=10*Math.random(),i.position.z=10*Math.random(),i.callback=orbClick,i.name=t[n].displayName,i.projectTitle=t[n].project,i.scale.x=i.scale.y=i.scale.z=t[n].scale,scene.add(i),spheres.push(i),rotations.push([getRandomArbitrary(.001,.01),getRandomArbitrary(1e-5,1e-4)])}(renderer=new THREE.WebGLRenderer).setPixelRatio(window.devicePixelRatio),container.appendChild(renderer.domElement);var o=window.innerWidth||2,a=window.innerHeight||2;(effect=new THREE.ParallaxBarrierEffect(renderer)).setSize(o,a),window.addEventListener("resize",onWindowResize,!1),raycaster=new THREE.Raycaster;var r=new THREE.DirectionalLight(13421772,.1),s=new THREE.RingGeometry(.3,.32,6),l=new THREE.MeshBasicMaterial({color:0,side:THREE.DoubleSide});(ring=new THREE.Mesh(s,l)).scale.set(.01,.1,.1),ring.title="cursor";var c=new THREE.SpriteMaterial({map:texture,color:0});(sprite=new THREE.Sprite(c)).scale.set(200,100,1),sprite.position.set(0,0,0),scene.add(sprite),scene.add(ring),scene.add(r),canvas=document.body.getElementsByTagName("canvas")[0]}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),effect.setSize(window.innerWidth,window.innerHeight),window.innerWidth<=400?camera.position.z=40:camera.position.z=20}function onDocumentMouseMove(e){e.preventDefault(),mouseX=(e.clientX-windowHalfX)/100,mouseY=(e.clientY-windowHalfY)/100,mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1,mouse.x=e.clientX/renderer.domElement.clientWidth*2-1,mouse.y=-e.clientY/renderer.domElement.clientHeight*2+1,raycaster.setFromCamera(mouse,camera),raycaster.intersectObjects(spheres).length>0?(canvas.style.cursor="pointer",sprite.position.copy(ring.position)):(resetCursor(),ring.rotation.copy(camera.rotation))}function animate(){requestAnimationFrame(animate),render()}function getRandomArbitrary(e,t){return Math.random()*(t-e)+e}function orbClick(e){if(!IS_OPEN){IS_OPEN=!0;var t=void 0!==e?e.object.projectTitle:"profile";document.getElementById(t).classList.remove("closed")}}function closeProject(e){e.preventDefault(),IS_OPEN=!1;for(var t=document.getElementsByClassName("sheet"),n=0;n<t.length;n++)t[n].classList.add("closed")}function resetCursor(){ring.scale.set(.01,.1,.1),canvas&&(canvas.style.cursor="default")}function easeInOut(e){return e<.1?2*e*e:(4-2*e)*e-1}function handleCursor(){var e=raycaster.intersectObjects(spheres);if(e.length>0){var t=e[0].object,n=(t.scale.x+2).toFixed(2),i=(t.scale.y+2).toFixed(2),o=(t.scale.z+2).toFixed(2);ring.scale.x.toFixed(2)<=n&&ring.scale.y.toFixed(2)<=i&&ring.scale.z.toFixed(2)<=o&&(ring.scale.x+=easeInOut(.37),ring.scale.y+=easeInOut(.37),ring.scale.z+=easeInOut(.37)),ring.scale.set(ring.scale.x,ring.scale.y,ring.scale.z),ring.position.x=t.position.x,ring.position.y=t.position.y,ring.position.z=t.position.z,ring.rotation.x+=.01,ring.rotation.y+=.01,ring.rotation.z+=.01}}function render(){var e=1e-4*Date.now();camera.position.x+=.05*(mouseX-camera.position.x),camera.position.y+=.05*(mouseY-camera.position.y),camera.lookAt(scene.position);for(var t=0,n=spheres.length;t<n;t++){var i=spheres[t];i.position.x=5*Math.cos(e+t),i.position.y=5*Math.sin(e+1.1*t),i.rotation.x+=rotations[t][0],i.rotation.y+=rotations[t][1]}raycaster.setFromCamera(mouse,camera);var o=raycaster.intersectObjects(scene.children);if(o.length>0){if(INTERSECTED!=o[0].object&&"cursor"!==o[0].object.title)if(INTERSECTED=o[0].object,o[0].object.name){tooltipContext.clearRect(0,0,640,480);var a=o[0].object.name,r=tooltipContext.measureText(a).width;tooltipContext.fillStyle="rgba(0,0,0,0.95)",tooltipContext.fillRect(0,0,r+8,28),tooltipContext.fillStyle="rgba(255,255,255,0.95)",tooltipContext.fillRect(2,2,r+4,24),tooltipContext.fillStyle="rgba(0,0,0,1)",tooltipContext.fillText(a,4,20),texture.needsUpdate=!0}else tooltipContext.clearRect(0,0,300,300),resetCursor(),texture.needsUpdate=!0}else INTERSECTED=null,tooltipContext.clearRect(0,0,300,300),texture.needsUpdate=!0,resetCursor();handleCursor(),effect.render(scene,camera)}function onMouseDown(e){e.preventDefault(),mouse.x=e.clientX/renderer.domElement.clientWidth*2-1,mouse.y=-e.clientY/renderer.domElement.clientHeight*2+1,raycaster.setFromCamera(mouse,camera);var t=raycaster.intersectObjects(spheres);t.length>0&&t[0].object.callback(t[0])}function openProfile(){orbClick()}init(),animate();var name=document.getElementById("name");document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mousedown",onMouseDown,!1),name.addEventListener("click",openProfile,!1);