var container,camera,scene,renderer,effect,raycaster,ring,canvas;!1===WEBGL.isWebGLAvailable()&&document.body.appendChild(WEBGL.getWebGLErrorMessage());var tooltip,texture,tooltipContext,sprite,spheres=[],rotations=[],opened=0,IS_OPEN=!1;tooltip=document.createElement("canvas"),(tooltipContext=tooltip.getContext("2d")).fillStyle="#FF0000",tooltipContext.font="Bold 20px Arial",tooltipContext.fillStyle="rgba(0,0,0,0.95)",tooltipContext.fillText("Adam here!",0,20),(texture=new THREE.Texture(tooltip)).needsUpdate=!0;var INTERSECTED,mouse=new THREE.Vector2,mouseX=0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2;function init(){container=document.createElement("div"),document.body.appendChild(container),(camera=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.01,100)).position.z=20,camera.focalLength=3,(scene=new THREE.Scene).background=new THREE.Color(16448250);var e=new THREE.RingGeometry(.3,.32,6),t=new THREE.MeshBasicMaterial({color:0,side:THREE.DoubleSide});(ring=new THREE.Mesh(e,t)).scale.set(.01,.1,.1),ring.title="cursor";for(var i=new THREE.IcosahedronBufferGeometry(.3,0),n=(new THREE.MeshStandardMaterial({emissive:6456575}),[new THREE.MeshBasicMaterial({color:14241092,side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({color:16106828,side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({color:0,side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({color:4549983,side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({color:16547665,side:THREE.DoubleSide}),new THREE.MeshBasicMaterial({color:11118252,side:THREE.DoubleSide})]),o=[{project:"wunderlist",material:new THREE.MeshStandardMaterial({emissive:14241092}),scale:5*Math.random()+1,displayName:"Wunderlist",visited:!1,ringMesh:new THREE.Mesh(e,n[0])},{project:"stickynotes",material:new THREE.MeshStandardMaterial({emissive:16106828}),scale:4*Math.random()+1,displayName:"Microsoft",visited:!1,ringMesh:new THREE.Mesh(e,n[1])},{project:"secret",material:new THREE.MeshStandardMaterial({emissive:0}),scale:2*Math.random()+1,displayName:"Secret",visited:!1,ringMesh:new THREE.Mesh(e,n[2])},{project:"photography",material:new THREE.MeshStandardMaterial({emissive:4549983}),scale:3*Math.random()+1,displayName:"Photography",visited:!1,ringMesh:new THREE.Mesh(e,n[3])},{project:"illustrations",material:new THREE.MeshStandardMaterial({emissive:16547665}),scale:2*Math.random()+1,displayName:"Illustrations",visited:!1,ringMesh:new THREE.Mesh(e,n[4])},{project:"knightlyrage",material:new THREE.MeshStandardMaterial({emissive:11118252}),scale:3*Math.random()+1,displayName:"Game Dev",visited:!1,ringMesh:new THREE.Mesh(e,n[5])}],r=0;r<o.length;r++){var a=new THREE.Mesh(i,o[r].material);o[r].material.shadowSide=THREE.DoubleSide,a.position.x=10*Math.random(),a.position.y=10*Math.random(),a.position.z=10*Math.random(),a.callback=orbClick,a.name=o[r].displayName,a.projectTitle=o[r].project,a.ring=o[r].ringMesh,a.ring.title="cursor",a.scale.x=a.scale.y=a.scale.z=o[r].scale,a.ring.visible=!1,scene.add(a),scene.add(a.ring),spheres.push(a),rotations.push([getRandomArbitrary(.001,.01),getRandomArbitrary(1e-5,1e-4)])}(renderer=new THREE.WebGLRenderer).setPixelRatio(window.devicePixelRatio),container.appendChild(renderer.domElement);var s=window.innerWidth||2,l=window.innerHeight||2;(effect=new THREE.ParallaxBarrierEffect(renderer)).setSize(s,l),window.addEventListener("resize",onWindowResize,!1),raycaster=new THREE.Raycaster;var c=new THREE.DirectionalLight(13421772,.1),d=new THREE.SpriteMaterial({map:texture,color:0});(sprite=new THREE.Sprite(d)).scale.set(200,100,1),sprite.position.set(0,0,0),scene.add(sprite),scene.add(ring),scene.add(c),canvas=document.body.getElementsByTagName("canvas")[0]}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),effect.setSize(window.innerWidth,window.innerHeight),window.innerWidth<=400?camera.position.z=40:camera.position.z=20}function onDocumentMouseMove(e){e.preventDefault(),mouseX=(e.clientX-windowHalfX)/100,mouseY=(e.clientY-windowHalfY)/100,mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-e.clientY/window.innerHeight*2+1,mouse.x=e.clientX/renderer.domElement.clientWidth*2-1,mouse.y=-e.clientY/renderer.domElement.clientHeight*2+1,raycaster.setFromCamera(mouse,camera),raycaster.intersectObjects(spheres).length>0?(canvas.style.cursor="pointer",sprite.position.copy(ring.position)):(resetCursor(),ring.rotation.copy(camera.rotation))}function animate(){requestAnimationFrame(animate),render()}function getRandomArbitrary(e,t){return Math.random()*(t-e)+e}function orbClick(e){if(!IS_OPEN){IS_OPEN=!0;var t=void 0!==e?e.object.projectTitle:"profile";document.getElementById(t).classList.remove("closed"),"profile"!==t&&window.setTimeout(function(){e.object.visited=!0,opened++},500)}}function closeProject(e){e.preventDefault(),IS_OPEN=!1;for(var t=document.getElementsByClassName("sheet"),i=0;i<t.length;i++)t[i].classList.add("closed");6===opened&&window.setTimeout(function(){document.getElementById("logomark").classList.add("open")},400)}function resetCursor(){ring.scale.set(.01,.1,.1),canvas&&(canvas.style.cursor="default")}function easeInOut(e){return e<.1?2*e*e:(4-2*e)*e-1}function handleCursor(){var e=raycaster.intersectObjects(spheres);if(e.length>0){var t=e[0].object,i=(t.scale.x+2).toFixed(2),n=(t.scale.y+2).toFixed(2),o=(t.scale.z+2).toFixed(2);ring.scale.x.toFixed(2)<=i&&ring.scale.y.toFixed(2)<=n&&ring.scale.z.toFixed(2)<=o&&(ring.scale.x+=easeInOut(.37),ring.scale.y+=easeInOut(.37),ring.scale.z+=easeInOut(.37)),ring.scale.set(ring.scale.x,ring.scale.y,ring.scale.z),ring.position.x=t.position.x,ring.position.y=t.position.y,ring.position.z=t.position.z,ring.rotation.x+=.01,ring.rotation.y+=.01,ring.rotation.z+=.01}}function render(){var e=1e-4*Date.now();camera.position.x+=.05*(mouseX-camera.position.x),camera.position.y+=.05*(mouseY-camera.position.y),camera.lookAt(scene.position);for(var t=0,i=spheres.length;t<i;t++){var n=spheres[t];n.position.x=5*Math.cos(e+t),n.position.y=5*Math.sin(e+1.1*t),n.rotation.x+=rotations[t][0],n.rotation.y+=rotations[t][1],n.visited&&(n.ring.visible=!0,n.ring.scale.set(n.scale.x+.5,n.scale.y+.5,n.scale.z+.5),n.ring.position.x=n.position.x,n.ring.position.y=n.position.y,n.ring.position.z=n.position.z,n.ring.rotation.x+=.005,n.ring.rotation.y+=.005,n.ring.rotation.z+=.005)}raycaster.setFromCamera(mouse,camera);var o=raycaster.intersectObjects(scene.children);if(o.length>0){if(INTERSECTED!=o[0].object&&"cursor"!==o[0].object.title)if(INTERSECTED=o[0].object,o[0].object.name){tooltipContext.clearRect(0,0,640,480);var r=o[0].object.name,a=tooltipContext.measureText(r).width;tooltipContext.fillStyle="rgba(0,0,0,0.95)",tooltipContext.fillRect(0,0,a+8,28),tooltipContext.fillStyle="rgba(255,255,255,0.95)",tooltipContext.fillRect(2,2,a+4,24),tooltipContext.fillStyle="rgba(0,0,0,1)",tooltipContext.fillText(r,4,20),texture.needsUpdate=!0}else tooltipContext.clearRect(0,0,300,300),resetCursor(),texture.needsUpdate=!0}else INTERSECTED=null,tooltipContext.clearRect(0,0,300,300),texture.needsUpdate=!0,resetCursor();handleCursor(),effect.render(scene,camera)}function onMouseDown(e){e.preventDefault(),mouse.x=e.clientX/renderer.domElement.clientWidth*2-1,mouse.y=-e.clientY/renderer.domElement.clientHeight*2+1,raycaster.setFromCamera(mouse,camera);var t=raycaster.intersectObjects(spheres);t.length>0&&t[0].object.callback(t[0])}function openProfile(){orbClick()}init(),animate();var headerName=document.getElementById("name");document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mousedown",onMouseDown,!1),headerName.addEventListener("click",openProfile,!1);